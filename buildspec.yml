version: 0.2
env:
  variables:
    DOTCOVER_VERSION: "2019.3.2"
    JUNITTESTLOGGER_VERSION: "1.1.0"
    REPOSITORY_NAME: "PFCoreHelloWorld"
phases:
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - $(aws ecr get-login --no-include-email --region $AWS_DEFAULT_REGION)

      - echo Installing .net core sdk 3.1 on Ubuntu 18.04
      - wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
      - dpkg -i packages-microsoft-prod.deb
      - add-apt-repository universe
      - apt-get update
      - apt-get install apt-transport-https
      - apt-get update
      - apt-get install -y dotnet-sdk-3.1
  build:
    commands:
      - echo Build started...
      - printenv
reports:
  TestReports:
    files: # publisihing test results
      - ./$BUILD_ARTIFACTS_PATH/TestResults.xml
artifacts:
  files: # publishing coverage report to S3
    - ./$BUILD_ARTIFACTS_PATH/**/*
